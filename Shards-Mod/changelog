0.15.x support, shorter code, bug fixes
